---
import { getCollection } from "astro:content";
import DocsLayout from "../../layouts/DocsLayout.astro";
import { buildSidebarTree, findEntryByRouteSlug } from "../../lib/docs";

const entries = await getCollection("docs");
const entry = findEntryByRouteSlug(entries);

if (!entry) {
  return new Response("Docs index not found. Create src/content/docs/index.md.", {
    status: 404,
  });
}

const { Content } = await entry.render();
const sidebar = buildSidebarTree(entries);
---

<DocsLayout sidebar={sidebar} currentSlug="index">
  <Content />
</DocsLayout>